@using Capstone.Web.Models
@using System.Collections.Generic
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model Card
<script type="text/javascript" src="../../Scripts/CardScripts/card.js"></script>


<h2 class="modify_header">Modify card</h2>

@Html.ActionLink("Return to cards", "CardView", "Card", new { @class = "submit_button" }) <span>All changes saved automatically</span>

@using (Html.BeginForm("CardEditFields", "Card", new { id = Model.CardID, front = Model.Front.Trim(), back = Model.Back.Trim(), tags = Model.ThisCardTags }, FormMethod.Get, new { @class = "edit_fields_action" }))
{
    <div>
        <p>front of card:</p>
        @Html.TextAreaFor(m => m.Front, new { @id = "front_field" })

        <p>back of card:</p>
        @Html.TextAreaFor(m => m.Back, new { @id = "back_field" })
    </div>
}

<p>tags:</p>

<div class="allTags">

    @foreach (string tag in Model.ThisCardTags)
    {
        <span class="card_tag">@tag</span>
        using (Html.BeginForm("RemoveCardTag", "Card", new { cardID = Model.CardID, tagName = tag }, FormMethod.Post, new { @class = "remove_tag_action" }))
        {
            @Html.HiddenFor(m => Model.CardID)
            <div id="@tag" class="remove_tag">x</div>
        }
    }

    <div class="addtag">add tag to card</div>

    @foreach (string tag in Model.AllTags)
    {
        if (!Model.ThisCardTags.Contains(tag))
        {
            using (Html.BeginForm("AddCardTag", "Card", new { cardID = Model.CardID, tagName = tag }, FormMethod.Post, new { @class = "add_tag_action" }))
            {
                <span id="@tag" class="add_tag inactive_tag">@tag</span>

            }
        }
    }

    <div class="createtag">create new tag for card</div>

    <div>
        @using (Html.BeginForm("CreateCardTag", "Card", FormMethod.Post))
        {

            <input name="TagName" />

            @Html.HiddenFor(m => Model.CardID)
            <input type="submit" class="list_item btn" value="Add New Tag">
        }
    </div>

</div>
